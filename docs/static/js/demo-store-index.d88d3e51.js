(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{"./demo/store/index.css":function(e,t,n){},"./demo/store/index.mdx":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return y}));var a=n("./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),o=n("react"),r=n.n(o),s=n("./node_modules/@mdx-js/react/dist/esm.js"),c=n("./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),u=n("./node_modules/antd/es/card/index.js"),l=n("./node_modules/antd/es/button/index.js"),i=n("./node_modules/antd/es/input/index.js"),m=n("./src/store.ts"),d=n("./node_modules/@vue/reactivity/dist/reactivity.esm-bundler.js"),b=Object(d.c)({count:0,message:"Hello",logs:[]});"undefined"!==typeof b&&b&&b===Object(b)&&Object.isExtensible(b)&&Object.defineProperty(b,"__filemeta",{enumerable:!0,configurable:!0,value:{name:"state",filename:"demo/store/store.ts"}});var p=Object(d.a)((function(){return b.count+1})),f=Object(d.a)((function(){return p.value+1}));Object(d.b)((function(){console.log("plusOne changed: ",p)}));var v={add:function(){return b.count+=1},log:function(e){return b.logs.unshift(e)},chat:function(e){return b.message=e}};"undefined"!==typeof v&&v&&v===Object(v)&&Object.isExtensible(v)&&Object.defineProperty(v,"__filemeta",{enumerable:!0,configurable:!0,value:{name:"mutations",filename:"demo/store/store.ts"}});var g={state:b,computed:{plusOne:p,plusTwo:f}};"undefined"!==typeof g&&g&&g===Object(g)&&Object.isExtensible(g)&&Object.defineProperty(g,"__filemeta",{enumerable:!0,configurable:!0,value:{name:"store",filename:"demo/store/store.ts"}}),"undefined"!==typeof Store&&Store&&Store===Object(Store)&&Object.isExtensible(Store)&&Object.defineProperty(Store,"__filemeta",{enumerable:!0,configurable:!0,value:{name:"Store",filename:"demo/store/store.ts"}});n("./demo/store/index.css"),n("./node_modules/antd/dist/antd.css");function O(){var e=Object(m.b)((function(e){var t=e.state,n=e.computed;return{count:t.count,plusOne:n.plusOne,plusTwo:n.plusTwo}}));return v.log("\u8ba1\u6570\u5668\u7ec4\u4ef6\u91cd\u65b0\u6e32\u67d3\ud83d\udc90"),r.a.createElement(u.a,{hoverable:!0,style:{marginBottom:24}},r.a.createElement("h1",null,"\u8ba1\u6570\u5668"),r.a.createElement("div",{className:"chunk"},r.a.createElement("div",{className:"text-chunk"},"store\u4e2d\u7684count\u73b0\u5728\u662f ",e.count),r.a.createElement("div",{className:"text-chunk"},"computed\u503c\u4e2d\u7684plusOne\u73b0\u5728\u662f ",e.plusOne.value),r.a.createElement("div",{className:"text-chunk"},"\u5d4c\u5957computed\u503c\u4e2d\u7684plusTwo\u73b0\u5728\u662f ",e.plusTwo.value),r.a.createElement(l.a,{onClick:v.add},"add")))}function j(){var e=Object(m.b)((function(e){return e.state.message})),t=Object(o.useState)(""),n=Object(c.a)(t,2),a=n[0],s=n[1];v.log("\u804a\u5929\u5ba4\u7ec4\u4ef6\u91cd\u65b0\u6e32\u67d3\ud83d\udc90");return r.a.createElement(u.a,{hoverable:!0,style:{marginBottom:24}},r.a.createElement("h1",null,"\u804a\u5929\u5ba4"),r.a.createElement("div",{className:"text-chunk"},"\u5f53\u524d\u6d88\u606f\u662f: ",e),r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),v.chat(a)}},r.a.createElement(i.a,{onChange:function(e){return s(e.target.value)},placeholder:"\u8bf7\u8f93\u5165\u6d88\u606f"})))}function h(){var e=Object(m.b)((function(e){return e.state.logs.map((function(e,t){return r.a.createElement("p",{className:"log",key:t},e)}))}));return r.a.createElement(u.a,{hoverable:!0},r.a.createElement("h1",null,"\u63a7\u5236\u53f0"),r.a.createElement("div",{className:"logs"},e))}var x=function(){return r.a.createElement(m.a,{value:g},r.a.createElement("div",{className:"flex"},r.a.createElement("div",{className:"left"},r.a.createElement("div",{className:"count"},r.a.createElement(O,null)),r.a.createElement("div",{className:"chat"},r.a.createElement(j,null))),r.a.createElement("div",{className:"right"},r.a.createElement(h,null))))},E={};function y(e){var t=e.components,n=Object(a.a)(e,["components"]);return Object(s.b)("wrapper",Object.assign({},E,n,{components:t,mdxType:"MDXLayout"}),Object(s.b)("h2",{id:"\u793a\u4f8b"},"\u793a\u4f8b"),Object(s.b)(x,{mdxType:"Counter"}),Object(s.b)("h3",{id:"store\u7684\u5b9a\u4e49"},"store\u7684\u5b9a\u4e49"),Object(s.b)("pre",null,Object(s.b)("code",Object.assign({parentName:"pre"},{className:"language-ts"}),"import { reactive, computed, effect } from '@vue/reactivity';\n\nexport const state = reactive({\n  count: 0,\n  message: 'Hello',\n  logs: [] as string[],\n});\n\nconst plusOne = computed(() => state.count + 1);\nconst plusTwo = computed(() => plusOne.value + 1);\n\neffect(() => {\n  console.log('plusOne changed: ', plusOne);\n});\n\nconst add = () => (state.count += 1);\nconst log = (log: string) => state.logs.unshift(log);\nconst chat = (message: string) => (state.message = message);\n\nexport const mutations = {\n  // mutation\n  add,\n  log,\n  chat,\n};\n\nexport const store = {\n  state,\n  computed: {\n    plusOne,\n    plusTwo,\n  },\n};\n\nexport type Store = typeof store;\n")),Object(s.b)("h2",{id:"codes"},"Codes"),Object(s.b)("pre",null,Object(s.b)("code",Object.assign({parentName:"pre"},{className:"language-tsx"}),'import React, { useState, useCallback } from \'react\';\nimport { Card, Button, Input } from \'antd\';\nimport { Provider, useStore } from \'../../src/store\';\nimport { store, mutations, Store } from \'./store\';\nimport \'./index.css\';\nimport \'antd/dist/antd.css\';\n\nfunction Count() {\n  const countState = useStore((store: Store) => {\n    const { state, computed } = store;\n    const { count } = state;\n    const { plusOne, plusTwo } = computed;\n\n    return {\n      count,\n      plusOne,\n      plusTwo,\n    };\n  });\n\n  mutations.log(\'\u8ba1\u6570\u5668\u7ec4\u4ef6\u91cd\u65b0\u6e32\u67d3\ud83d\udc90\');\n\n  return (\n    <Card hoverable style={{ marginBottom: 24 }}>\n      <h1>\u8ba1\u6570\u5668</h1>\n      <div className="chunk">\n        <div className="text-chunk">store\u4e2d\u7684count\u73b0\u5728\u662f {countState.count}</div>\n        <div className="text-chunk">computed\u503c\u4e2d\u7684plusOne\u73b0\u5728\u662f {countState.plusOne.value}</div>\n        <div className="text-chunk">\u5d4c\u5957computed\u503c\u4e2d\u7684plusTwo\u73b0\u5728\u662f {countState.plusTwo.value}</div>\n        <Button onClick={mutations.add}>add</Button>\n      </div>\n    </Card>\n  );\n}\n\nfunction Chat() {\n  const message = useStore((store: Store) => store.state.message);\n  const [value, setValue] = useState(\'\');\n\n  mutations.log(\'\u804a\u5929\u5ba4\u7ec4\u4ef6\u91cd\u65b0\u6e32\u67d3\ud83d\udc90\');\n\n  const onSubmit = (e: React.FormEvent<HTMLFormElement>) => {\n    e.preventDefault();\n    mutations.chat(value);\n  };\n\n  return (\n    <Card hoverable style={{ marginBottom: 24 }}>\n      <h1>\u804a\u5929\u5ba4</h1>\n      <div className="text-chunk">\u5f53\u524d\u6d88\u606f\u662f: {message}</div>\n      <form onSubmit={onSubmit}>\n        <Input onChange={e => setValue(e.target.value)} placeholder="\u8bf7\u8f93\u5165\u6d88\u606f" />\n      </form>\n    </Card>\n  );\n}\n\nfunction Logger() {\n  const logs = useStore((store: Store) => {\n    return store.state.logs.map((log, idx) => (\n      <p className="log" key={idx}>\n        {log}\n      </p>\n    ));\n  });\n\n  return (\n    <Card hoverable>\n      <h1>\u63a7\u5236\u53f0</h1>\n      <div className="logs">{logs}</div>\n    </Card>\n  );\n}\n\nexport default () => {\n  return (\n    <Provider value={store}>\n      <div className="flex">\n        <div className="left">\n          <div className="count">\n            <Count />\n          </div>\n          <div className="chat">\n            <Chat />\n          </div>\n        </div>\n        <div className="right">\n          <Logger />\n        </div>\n      </div>\n    </Provider>\n  );\n};\n\n')))}y&&y===Object(y)&&Object.isExtensible(y)&&Object.defineProperty(y,"__filemeta",{enumerable:!0,configurable:!0,value:{name:"MDXContent",filename:"demo/store/index.mdx"}}),y.isMDXComponent=!0},"./src/store.ts":function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return m}));var a=n("react"),o=n.n(a),r=n("./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),s=n("./node_modules/@vue/reactivity/dist/reactivity.esm-bundler.js"),c=function(){var e=Object(a.useReducer)((function(e){return e+1}),0);return Object(r.a)(e,2)[1]};c&&c===Object(c)&&Object.isExtensible(c)&&Object.defineProperty(c,"__filemeta",{enumerable:!0,configurable:!0,value:{name:"useForceUpdate",filename:"src/share.ts"}});var u=function(){var e=Object(a.useRef)();e.current||(e.current=s.b.apply(void 0,arguments));var t=function(){Object(s.d)(e.current)};return Object(a.useEffect)((function(){return t}),[]),e.current};u&&u===Object(u)&&Object.isExtensible(u)&&Object.defineProperty(u,"__filemeta",{enumerable:!0,configurable:!0,value:{name:"useEffection",filename:"src/share.ts"}});var l=o.a.createContext(null),i=function(e){var t=c(),n=function(){var e=Object(a.useContext)(l);if(!e)throw new Error("could not find store context value; please ensure the component is wrapped in a <Provider>");return e}();return u((function(){return e(n)}),{scheduler:function(e){void 0!==e()&&t()},lazy:!0})()};"undefined"!==typeof i&&i&&i===Object(i)&&Object.isExtensible(i)&&Object.defineProperty(i,"__filemeta",{enumerable:!0,configurable:!0,value:{name:"useStore",filename:"src/store.ts"}});var m=l.Provider;"undefined"!==typeof m&&m&&m===Object(m)&&Object.isExtensible(m)&&Object.defineProperty(m,"__filemeta",{enumerable:!0,configurable:!0,value:{name:"Provider",filename:"src/store.ts"}})}}]);